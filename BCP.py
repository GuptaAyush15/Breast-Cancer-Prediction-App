# -*- coding: utf-8 -*-
"""Untitled8.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1BuLqkaTzhucM7CUsFjGr6TWKcD9juyYm
"""

# Step 1: Install IPyWidgets (if not already)
!pip install ipywidgets --quiet

# Step 2: Import Libraries
import pandas as pd
from sklearn.datasets import load_breast_cancer
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.ensemble import RandomForestClassifier
from IPython.display import display
import ipywidgets as widgets

# Step 3: Load Dataset and Train Model
data = load_breast_cancer()

# Define the features to be used by the sliders
selected_features = ['mean radius', 'mean texture', 'mean perimeter', 'mean area', 'mean smoothness']

# Create X with only the selected features for training the model
X = pd.DataFrame(data.data, columns=data.feature_names)[selected_features]
y = pd.Series(data.target)

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

model = RandomForestClassifier(n_estimators=100, random_state=42)
model.fit(X_train_scaled, y_train)

# Step 4: Create Widgets
radius_slider = widgets.FloatSlider(min=6.0, max=30.0, step=0.1, value=14.0, description='Mean Radius:')
texture_slider = widgets.FloatSlider(min=9.0, max=40.0, step=0.1, value=20.0, description='Mean Texture:')
perimeter_slider = widgets.FloatSlider(min=40.0, max=200.0, step=0.1, value=90.0, description='Mean Perimeter:')
area_slider = widgets.FloatSlider(min=100.0, max=2500.0, step=0.1, value=600.0, description='Mean Area:')
smoothness_slider = widgets.FloatSlider(min=0.05, max=0.2, step=0.001, value=0.1, description='Mean Smoothness:')
predict_button = widgets.Button(description="Predict", button_style='success')
output = widgets.Output()

# Step 5: Define Prediction Function
def predict_breast_cancer(b):
    input_data = pd.DataFrame([[radius_slider.value, texture_slider.value,
                                perimeter_slider.value, area_slider.value,
                                smoothness_slider.value]],
                              columns=selected_features) # Use selected_features for consistency
    input_scaled = scaler.transform(input_data)
    pred = model.predict(input_scaled)[0]
    prob = model.predict_proba(input_scaled)[0][pred]

    with output:
        output.clear_output()
        if pred == 0:
            print(f"⚠️ Malignant (Confidence: {prob*100:.2f}%)")
        else:
            print(f"✅ Benign (Confidence: {prob*100:.2f}%)")

predict_button.on_click(predict_breast_cancer)

# Step 6: Display Widgets
display(radius_slider, texture_slider, perimeter_slider, area_slider, smoothness_slider, predict_button, output)